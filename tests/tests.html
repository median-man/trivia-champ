<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Trivia Champ</title>
  <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.5.1.css">
</head>

<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <script src="../assets/js/openTriviaDB.js"></script>
  <script src="../assets/js/makeQuestion.js"></script>
  <script src="../assets/js/app.js"></script>
  <script src="https://code.jquery.com/qunit/qunit-2.5.1.js"></script>
  <script>
    const { test } = QUnit;
    addCustomAssertions(QUnit.assert);
    function addCustomAssertions(assert) {
      assert.isFunction = assertIsFunction;
      assert.includes = assertIncludes;
      assert.attrIncludes = attributesInclude;
    }
    function assertIsFunction(func, message = 'is a function') {
      const result = {
        result: func instanceof Function,
        actual: func,
        expected: typeof (() => { }),
        message,
      };
      this.pushResult(result);
    };

    function assertIncludes(target, search, message) {
      let result;
      let actual;
      if (Array.isArray(search)) {
        actual = search.filter(value => target.includes(value));
        result = actual.length === search.length;
      } else {
        result = target.includes(search);
        actual = target;
      }
      const resultObj = {
        result,
        actual,
        expected: search,
        message,
      }
      this.pushResult(resultObj);
    }

    function attributesInclude(element, expected, message) {
      const actual = {};
      const result = Object.keys(expected).every(attrEqual);

      function attrEqual(attr) {
        let passes = true;
        const expectedVal = expected[attr];
        const actualVal = element.getAttribute(attr);
        if (!actualVal) {
          passes = false;
        } else {
          actual[attr] = actualVal;
        }
        if (actualVal != expectedVal) {
          passes = false;
        }
        return passes;
      }
      this.pushResult({ result, expected, actual, message });
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sinon.js/5.0.0/sinon.min.js"></script>
  <script src="js/test.openTriviaDB.js"></script>
  <script src="js/test.app.js"></script>
  <script src="js/test.makeQuestion.js"></script>
</body>

</html>
